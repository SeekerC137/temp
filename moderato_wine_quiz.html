<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MODERATO — Фудпейринг: выберите 4 характеристики блюда</title>
  <style>
    :root{
      --bg:#ffffff;
      --ink:#111111;
      --muted:#6f6f6f;
      --accent:#B38B59;
      --border:#e9e9e9;
      --radius:14px;
      --shadow:0 10px 30px rgba(0,0,0,.06);
      --font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,"Noto Sans",sans-serif;
    }
    body{margin:0;background:#fff;color:var(--ink);font-family:var(--font);}
    .wrap{max-width: 1000px; margin: 24px auto; padding: 0 16px;}
    #wine-quiz{max-width: 880px;margin: 24px auto;background: var(--bg);color: var(--ink);border: 1px solid var(--border);border-radius: var(--radius);box-shadow: var(--shadow);overflow: hidden;}
    .wq-header{padding: 28px 28px 8px;border-bottom: 1px solid var(--border);background: linear-gradient(180deg,#fff, #fff8f0 160%);}
    .wq-kicker{text-transform: uppercase;letter-spacing: .12em;font-size: 12px;color: var(--muted);margin-bottom: 6px;}
    .wq-title{font-size: 32px;line-height: 1.15;letter-spacing: .02em;margin: 0 0 8px 0;}
    .wq-sub{color: var(--muted);font-size: 14px;margin: 0 0 14px 0;}
    .wq-progress{height: 6px;background:#f4f4f4;border-radius:8px;overflow:hidden;}
    .wq-progress > span{display:block;height: 100%;width: 0%;background: var(--accent);transition: width .35s ease;}
    .wq-body{padding: 28px;}
    .wq-question{font-size: 20px;letter-spacing:.02em;margin: 0 0 18px 0;}
    .wq-options{display: grid;grid-template-columns: repeat(2, minmax(0,1fr));gap: 12px;}
    @media (max-width:720px){.wq-options{ grid-template-columns: 1fr; }}
    .wq-option{position:relative;padding: 14px 16px;border: 1px solid var(--border);border-radius: 12px;background: #fff;cursor: pointer;transition: transform .08s ease, box-shadow .2s ease, border-color .2s ease;text-align:left;}
    .wq-option:hover{transform: translateY(-1px);box-shadow: 0 8px 20px rgba(0,0,0,.06);border-color: #dedede;}
    .wq-option strong{display:block;font-size: 16px;margin-bottom: 4px;letter-spacing:.02em;}
    .wq-option small{color: var(--muted);font-size: 12px;}
    .wq-nav{display:flex;gap:10px;justify-content: space-between;align-items:center;margin-top: 18px;padding: 0 28px 24px;}
    .wq-left, .wq-right{ display:flex; gap:10px; flex-wrap: wrap;}
    .wq-btn{appearance:none;border:none;cursor:pointer;border-radius: 999px;padding: 12px 18px;font-weight: 600;letter-spacing:.06em;text-transform: uppercase;background:#f6f6f6;color:#222;transition: transform .06s ease, box-shadow .2s ease, background .2s ease;text-decoration:none;}
    .wq-btn:hover{ transform: translateY(-1px); box-shadow: 0 8px 20px rgba(0,0,0,.06); }
    .wq-btn:disabled{ opacity:.5; cursor:not-allowed; }
    .wq-btn--accent{background: var(--ink);color: #fff;}
    .wq-btn--outline{background:#fff;border:1px solid var(--border);}
    .wq-result{border: 1px dashed var(--border);border-radius: 12px;padding: 18px;background: #fff;}
    .wq-result h3{margin:0 0 8px 0;font-size: 24px;letter-spacing:.02em;}
    .wq-tags{display:flex; flex-wrap: wrap; gap:8px; margin-top:10px;}
    .wq-tag{padding:6px 10px; border:1px solid var(--border);border-radius:999px; font-size:12px; color:var(--muted);background:#fff;}
    .wq-footnote{margin-top: 14px; color: var(--muted); font-size: 12px;}
    .wq-screen{ opacity:0; transform: translateY(6px); animation:fadeIn .25s ease forwards; }
    .wq-cta{margin-top:16px;padding:16px;border:1px solid var(--border);border-radius:12px;background:#fff;}
    .wq-cta p{margin:0 0 10px 0;}
    @keyframes fadeIn{ to{ opacity:1; transform:none; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="wine-quiz-root"></div>
  </div>

  <script>
  (function(){
    // 4 ВОПРОСА: Цвет блюда → Вес → Кислотность/Насыщенность → Аромат
    const QUESTIONS = [
      {
        id: "color",
        title: "MODERATO — Фудпейринг",
        question: "Шаг 1. Цвет блюда. Что на тарелке доминирует по цвету?",
        note: "Двигайтесь слева направо по характеристикам блюда и подсказкам: Цвет → Вес → Кислотность/Насыщенность → Аромат.", // из таблицы
        options: [
          {value:"light", label:"Светлое", hint:"рыба, морепродукты, белое мясо, светлые соусы"},
          {value:"pink",  label:"Розовое/ора́нжевое", hint:"лосось, креветки, томат, тапас"},
          {value:"red",   label:"Тёмное/красное", hint:"красное мясо, томлёные соусы, гриль"},
          {value:"any",   label:"Разноцветные закуски", hint:"фуршет, аперитив, универсально"}
        ]
      },
      {
        id: "body",
        question: "Шаг 2. Вес (тельность) блюда. Как ощущается блюдо?",
        options: [
          {value:"light",  label:"Лёгкое", hint:"хрустящее, деликатные текстуры"},
          {value:"medium", label:"Среднее", hint:"птица, паста, сливочные ноты"},
          {value:"full",   label:"Насыщенное", hint:"жареное, жирное, стейк, BBQ"}
        ]
      },
      {
        id: "acidity",
        question: "Шаг 3. Кислотность/Насыщенность сопровождения.",
        options: [
          {value:"high",   label:"Выраженная кислотность", hint:"цитрус, маринады, каперсы"},
          {value:"moderate",label:"Умеренная", hint:"баланс без резких акцентов"},
          {value:"low",    label:"Невысокая/сливочная", hint:"сливки, масло, запекание"}
        ]
      },
      {
        id: "aroma",
        question: "Шаг 4. Ароматика блюда. Просите ароматность или пряности?",
        options: [
          {value:"neutral", label:"Сдержанная", hint:"чистый вкус продукта"},
          {value:"aromatic",label:"Ароматное", hint:"цитрус, травы, цветы"},
          {value:"spicy",   label:"Пряное/со специями", hint:"перец, копчёности, BBQ"}
        ]
      }
    ];

    // 12 результатов
    const RESULTS = {
      sparkling:  {title:"Игристое Brut/Extra Brut",
        desc:"Универсальный аперитив к разноцветным закускам, сырам и морепродуктам. Высокая свежесть — выстраивает стол и настроение.",
        tags:["Шампань/Кава/Креман","Высокая кислотность","Аперитив","Универсально"]},
      white_marine:{title:"Свежее минеральное белое",
        desc:"Соль моря и цитрус: идеальная пара к устрицам, креветкам, рыбе. Хрусткость подчёркивает деликатные текстуры.",
        tags:["Мускаде/Чабли/Ассиртико","Морепродукты","Минеральность"]},
      white_aromatic:{title:"Ароматное белое (дружелюбное)",
        desc:"Фрукт и пряности для азиатской кухни и ярких соусов. Балансирует сладковато-пряные нотки.",
        tags:["Рислинг off-dry/Гевюрцтраминер","Фрукты","Пряности"]},
      white_sauv:{title:"Совиньон-стиль (цитрус/зелень)",
        desc:"Травянистая свежесть, хрусткость и лимонная линия — к салатам, козьему сыру, белой рыбе.",
        tags:["Sauvignon Blanc","Зелень","Хрусткость"]},
      white_floral:{title:"Флорально-фруктовое белое",
        desc:"Нежные косточковые и цветы: гибкая гастрономичность к пасте, птице, мягким сливочным соусам.",
        tags:["Альбариньо/Грюнер/Вердиккьо","Среднее тело","Гибко"]},
      white_chard:{title:"Полное сливочное белое",
        desc:"Шардоне с кремовой текстурой — к запечённой рыбе, жареной птице и сливочным соусам.",
        tags:["Шардоне (Бургундия/Новый Свет)","Невысокая кислотность","Сливочность"]},
      rose_prov:{title:"Сухое розовое (Прованс)",
        desc:"Хрусткое и гастрономичное: рыба, овощи, лёгкие закуски. Идеально «на стол».",
        tags:["Прованс","Сухость","Гастрономичность"]},
      rose_fruity:{title:"Фруктовое розовое",
        desc:"Ягодная дружелюбность для фуршетов, пиццы и тапас. Пьётся легко и широко сочетается.",
        tags:["Ягоды","Лёгкость","Фуршет"]},
      red_light:{title:"Лёгкое ягодное красное",
        desc:"Гаме/Пино: охлаждаем слегка — к птице, пасте, тунцу. Низкий танин, чистая ягода.",
        tags:["Гаме/Пино Нуар","Низкий танин","Свежесть"]},
      red_medium_fruit:{title:"Среднетелое фруктовое красное",
        desc:"Мягкие таннины и спелая фруктовость — к свинине, телятине, рагу.",
        tags:["Мерло/Темпранильо","Бархатистость"]},
      red_medium_oak:{title:"Среднетелое с бочкой/пряностями",
        desc:"Копчёно-пряные акценты для запечённого мяса и зрелых сыров.",
        tags:["Риоха Резерва/Купажи","Дуб","Пряности"]},
      red_full:{title:"Плотное танинное красное",
        desc:"Каберне и стейки: когда подача — перец и несладкие соусы, структура вина работает на блюдо.",
        tags:["Cabernet Sauvignon","Высокий танин","Стейк"]}
    };

    const root = document.getElementById('wine-quiz-root');
    const state = { step:0, answers:{} };

    function el(tag, props={}, children=[]){
      const n = document.createElement(tag);
      Object.assign(n, props);
      (Array.isArray(children)?children:[children]).filter(Boolean).forEach(c=>{
        if(typeof c === 'string'){ n.appendChild(document.createTextNode(c)); }
        else n.appendChild(c);
      });
      return n;
    }

    function progressPct(){ return Math.round((state.step / QUESTIONS.length) * 100); }

    function decideResult(a){
      // Правила подбора (упрощённая матрица 4×3×3×3 → 12 стилей)
      const {color, body, acidity, aroma} = a;

      // Универсальный случай фуршета/микс
      if(color === "any"){
        if(acidity === "high") return "sparkling";
        return (aroma === "aromatic") ? "rose_prov" : "rose_fruity";
      }

      // Светлые блюда
      if(color === "light"){
        if(body === "light"){
          if(acidity === "high") return "white_marine";
          return (aroma === "aromatic") ? "white_sauv" : "white_floral";
        }
        if(body === "medium"){
          if(acidity === "high") return "white_sauv";
          return (aroma === "aromatic") ? "white_floral" : "white_floral";
        }
        // full
        if(acidity === "low") return "white_chard";
        return (aroma === "spicy") ? "white_floral" : "white_chard";
      }

      // Розово-оранжевая тарелка
      if(color === "pink"){
        if(body === "light") return (acidity === "high") ? "rose_prov" : "rose_fruity";
        if(body === "medium") return (aroma === "aromatic") ? "rose_prov" : "rose_fruity";
        // full
        return (aroma === "spicy") ? "rose_fruity" : "rose_prov";
      }

      // Тёмные/красные блюда
      if(color === "red"){
        if(body === "light"){
          return (aroma === "spicy") ? "red_medium_fruit" : "red_light";
        }
        if(body === "medium"){
          if(aroma === "spicy") return "red_medium_oak";
          return (acidity === "high") ? "red_light" : "red_medium_fruit";
        }
        // full
        if(aroma === "spicy") return "red_medium_oak";
        return "red_full";
      }

      // fallback
      return "sparkling";
    }

    function render(){
      root.innerHTML = '';
      const shell = el('div',{id:'wine-quiz'});

      // Header
      const header = el('div',{className:'wq-header wq-screen'},[
        el('div',{className:'wq-kicker'},'МОДЕРАТО — ТЕСТ-ПОДБОР'),
        el('h2',{className:'wq-title'},'Подберите вино к блюду за 4 шага'),
        el('p',{className:'wq-sub'},'Цвет → Вес → Кислотность/Насыщенность → Аромат. Настоящий вкус раскрывается только в паре «вино + блюдо».'),
        // ↑ формула и фраза из вашей таблицы
        (()=> {
          const bar = el('div',{className:'wq-progress'},[ el('span') ]);
          requestAnimationFrame(()=>{ bar.firstChild.style.width = progressPct()+'%'; });
          return bar;
        })()
      ]);
      shell.appendChild(header);

      const body = el('div',{className:'wq-body wq-screen'});

      if(state.step < QUESTIONS.length){
        const q = QUESTIONS[state.step];
        if(q.title) body.appendChild(el('div',{className:'wq-kicker'}, q.title));
        body.appendChild(el('h3',{className:'wq-question'}, q.question));
        if(q.note) body.appendChild(el('p',{className:'wq-sub'}, q.note));

        const list = el('div',{className:'wq-options'});
        q.options.forEach(opt=>{
          const card = el('button',{className:'wq-option', type:'button'});
          card.appendChild(el('strong',{},opt.label));
          if(opt.hint){ card.appendChild(el('small',{},opt.hint)); }
          card.addEventListener('click', ()=>{
            state.answers[q.id||q.question] = opt.value;
            state.step++;
            render();
          });
          list.appendChild(card);
        });
        body.appendChild(list);

      } else {
        const resId = decideResult(state.answers);
        const r = RESULTS[resId];

        body.appendChild(el('div',{className:'wq-result'},[
          el('h3',{}, r.title),
          el('p',{}, r.desc),
          el('div',{className:'wq-tags'}, r.tags.map(t=>el('span',{className:'wq-tag'}, t)))
        ]));

        body.appendChild(el('p',{className:'wq-footnote'},
          'Подсказка: соотнесите стиль вина с выбранными характеристиками блюда. Настоящий вкус раскрывается в паре «вино + блюдо».'
        ));

        // CTA — «Хотите обладать знаниями…»
        const cta = el('div',{className:'wq-cta'},[
          el('p',{}, 'Хотите обладать знаниями для самостоятельного выбора вин? Превратите таблицу в навык, который всегда работает — приходите на курс «Азбука вина».'),
          el('a',{
            className:'wq-btn wq-btn--accent',
            href:'https://moderato-sv.ru/abc_wine/?utm_source=foodpairing#b12690',
            target:'_blank',
            rel:'noopener'
          }, 'Записаться на курс')
        ]);
        body.appendChild(cta);
      }

      // Навигация
      const nav = el('div',{className:'wq-nav wq-screen'});
      const left = el('div',{className:'wq-left'});
      const right = el('div',{className:'wq-right'});

      const backBtn = el('button',{className:'wq-btn wq-btn--outline', type:'button', disabled: state.step===0},'Назад');
      backBtn.addEventListener('click', ()=>{
        if(state.step>0){ state.step--; }
        render();
      });

      const resetBtn = el('button',{className:'wq-btn', type:'button'},'Сначала');
      resetBtn.addEventListener('click', ()=>{
        state.step = 0;
        state.answers = {};
        render();
      });

      left.appendChild(backBtn);
      left.appendChild(resetBtn);
      nav.appendChild(left);
      nav.appendChild(right);

      shell.appendChild(body);
      shell.appendChild(nav);
      root.appendChild(shell);
    }

    function init(){ state.step = 0; state.answers = {}; render(); }
    if(document.readyState === 'loading'){ document.addEventListener('DOMContentLoaded', init); } else { init(); }
  })();
  </script>
</body>
</html>
